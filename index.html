<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Twitch 自定义播放器</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/video.js/8.3.0/video-js.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/8.3.0/video.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #18181b;
            color: white;
            margin: 0;
            padding: 20px;
        }
        h1 {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <h1>正在直播：Maximarex02</h1>

    <!-- 自定义 Twitch 直播播放器 -->
    <video id="twitch-player" class="video-js vjs-default-skin" controls width="800" height="450"></video>

    <script>
        async function loadTwitchStream() {
            try {
                // 获取 Twitch Token 和 Sig
                let tokenResponse = await fetch("https://api.twitch.tv/api/channels/maximarex02/access_token", {
                    headers: {
                        "Client-ID": "YOUR_CLIENT_ID",
                        "Authorization": "Bearer YOUR_ACCESS_TOKEN"
                    }
                });

                let tokenData = await tokenResponse.json();
                let token = encodeURIComponent(tokenData.token);
                let sig = encodeURIComponent(tokenData.sig);

                // 生成 .m3u8 播放链接
                let m3u8Url = `https://usher.ttvnw.net/api/channel/hls/maximarex02.m3u8?token=${token}&sig=${sig}`;

                // 初始化 Video.js 播放器
                var player = videojs('twitch-player', {
                    autoplay: true,
                    controls: true,
                    preload: 'auto'
                });

                // 设置直播流
                player.src({
                    src: m3u8Url,
                    type: 'application/x-mpegURL'
                });

                player.play();
            } catch (error) {
                console.error("加载 Twitch 直播失败:", error);
            }
        }

        // 运行获取直播流的函数
        loadTwitchStream();
    </script>

</body>
</html>
